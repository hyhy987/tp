@startuml
skin rose
skinparam ActivityFontSize 15
skinparam ArrowFontSize 12
skinparam ActivityBorderColor #555555
skinparam ActivityBackgroundColor #f8f8f8
skinparam ArrowColor #555555
skinparam NoteBackgroundColor #fffde7
skinparam NoteBorderColor #bdbdbd
title FoodBook — Commit Flow

start
:User executes a CLI command;

' 1) Handle UNDO explicitly (no Redo feature in app)
if () then ([command = 'undo'])
  if () then ([Undo History Not Empty])
    :Restore previous Model snapshot\n(from Undo history);
    :Auto-save to JSON;
    :Show 'Command undone: [command]';
  else ([else])
    :Show 'You cannot undo any further';
  endif
  stop
  else ([else])
endif

' 2) For non-undo commands, check if they modify data
if () then ([Modifies Stored Data])
  :Validate inputs (formats, duplicates, existence);
  :Push current Model snapshot onto Undo history;
  :Apply change to in-memory Model;
  note left
    Commands that MODIFY (commit):
    • add_client, edit_client, delete_client
    • add_delivery, edit_delivery, delete_delivery
    • mark, unmark
    • clear
  end note
else ([else])
  :No data change recorded;
  :Update filtered lists / UI only;
  note right
    Read-only (no commit):
    • list, list_delivery, list_revenue
    • find, find_delivery
    • help, exit
  end note
endif
:Auto-save to JSON;
:Show  message;
stop
@enduml
